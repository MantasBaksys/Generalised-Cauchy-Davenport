%
\begin{isabellebody}%
\setisabellecontext{Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}preliminaries}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Preliminaries on well-orderings, groups, and sumsets%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}preliminaries\isanewline
\ \ \isakeyword{imports}\ \isanewline
\ Complex{\isacharunderscore}{\kern0pt}Main\isanewline
\ {\isachardoublequoteopen}Jacobson{\isacharunderscore}{\kern0pt}Basic{\isacharunderscore}{\kern0pt}Algebra{\isachardot}{\kern0pt}Group{\isacharunderscore}{\kern0pt}Theory{\isachardoublequoteclose}\isanewline
\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Well-ordering lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharunderscore}{\kern0pt}inter{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{fixes}\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{and}\ g\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ t\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}c\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ h{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ h{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ range\ f\ {\isasymLongrightarrow}\ wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ h{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}trans\ t{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ h{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t\isanewline
\ \ \ \ {\isasymsubseteq}\ inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a{\isasymin}range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ inv{\isacharunderscore}{\kern0pt}image\ s\ g\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isacommand{assume}\isamarkupfalse%
\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ a{\isacharcomma}{\kern0pt}\ f\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ r\ {\isasymor}\ {\isacharparenleft}{\kern0pt}f\ a\ {\isacharequal}{\kern0pt}\ f\ b\ {\isasymand}\ {\isacharparenleft}{\kern0pt}g\ a{\isacharcomma}{\kern0pt}\ g\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ in{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}prod\ Int{\isacharunderscore}{\kern0pt}iff\ SigmaE\ UNIV{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}UNIV\ inf{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}right\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a{\isasymin}range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ inv{\isacharunderscore}{\kern0pt}image\ s\ g\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hy\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a{\isasymin}range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ inv{\isacharunderscore}{\kern0pt}image\ s\ g\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ \isanewline
\ \ \ \ \ \ inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ Int{\isacharunderscore}{\kern0pt}iff\ SUP{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff\ SigmaD{\isadigit{1}}\ SigmaD{\isadigit{2}}\ \isanewline
\ \ \ \ \ \ in{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ in{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}prod\ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq\ subrelI\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ O\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isadigit{3}}\ trans{\isacharunderscore}{\kern0pt}O{\isacharunderscore}{\kern0pt}subset\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ wf{\isacharunderscore}{\kern0pt}UN{\isacharcomma}{\kern0pt}\ auto\ simp\ add{\isacharcolon}{\kern0pt}\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}compatible{\isacharbrackleft}{\kern0pt}OF\ h{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{fixes}\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{and}\ g\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ h{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ h{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ range\ f\ {\isasymLongrightarrow}\ wf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ trans{\isacharunderscore}{\kern0pt}def\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharunderscore}{\kern0pt}inter{\isacharbrackleft}{\kern0pt}of\ r\ f\ UNIV\ s\ g{\isacharbrackright}{\kern0pt}\ inf{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}right\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ iso{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}UNIV{\isacharunderscore}{\kern0pt}I{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{context}\isamarkupfalse%
\ monoid\isanewline
\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Pointwise set multiplication in a monoid: definition and key lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{inductive{\isacharunderscore}{\kern0pt}set}\isamarkupfalse%
\ smul\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ \isakeyword{for}\ A\ B\ \isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ smulI{\isacharbrackleft}{\kern0pt}intro{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}a\ {\isasymin}\ A{\isacharsemicolon}{\kern0pt}\ a\ {\isasymin}\ M{\isacharsemicolon}{\kern0pt}\ b\ {\isasymin}\ B{\isacharsemicolon}{\kern0pt}\ b\ {\isasymin}\ M{\isasymrbrakk}\ {\isasymLongrightarrow}\ a\ {\isasymcdot}\ b\ {\isasymin}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{syntax}\isamarkupfalse%
\ {\isachardoublequoteopen}smul{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isasymcdots}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}c{\isachardot}{\kern0pt}\ {\isasymexists}a\ {\isasymin}\ A\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ {\isasymexists}b\ {\isasymin}\ B\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ c\ {\isacharequal}{\kern0pt}\ a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}simps\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a\ {\isasymin}\ A\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ {\isasymUnion}b\ {\isasymin}\ B\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}carrier\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}A{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ A{\isacharsemicolon}{\kern0pt}\ B{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ B{\isasymrbrakk}\ {\isasymLongrightarrow}\ smul\ A{\isacharprime}{\kern0pt}\ B{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}insert{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}NO{\isacharunderscore}{\kern0pt}MATCH\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ A\ {\isasymLongrightarrow}\ smul\ {\isacharparenleft}{\kern0pt}insert\ x\ A{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ smul\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ B\ {\isasymunion}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}insert{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}NO{\isacharunderscore}{\kern0pt}MATCH\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ B\ {\isasymLongrightarrow}\ smul\ A\ {\isacharparenleft}{\kern0pt}insert\ x\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ smul\ A\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ A{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ smul\ A\ B\ {\isasymunion}\ smul\ A{\isacharprime}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymunion}\ B{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ smul\ A\ B\ {\isasymunion}\ smul\ A\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Union{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ A{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ A{\isachardot}{\kern0pt}\ smul\ a\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Union{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ b\ {\isasymin}\ B{\isachardot}{\kern0pt}\ smul\ A\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}insert{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ A\ {\isacharparenleft}{\kern0pt}insert\ x\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ {\isacharparenleft}{\kern0pt}insert\ x\ A{\isacharparenright}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ A\ {\isacharparenleft}{\kern0pt}B{\isasymunion}C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ {\isacharparenleft}{\kern0pt}A{\isasymunion}C{\isacharparenright}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}empty\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}empty{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}smul\ B\ A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymlongleftrightarrow}\ A\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ B\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}D\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ A\ {\isasyminter}\ M{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ A\ {\isasyminter}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}carrier{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}\ C\ {\isacharequal}{\kern0pt}\ smul\ A\ {\isacharparenleft}{\kern0pt}smul\ B\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq\ associative\ Bex{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}smul{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\ \ \isakeyword{shows}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}smul{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}B\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Exponentiation in a monoid: definitions and lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primrec}\isamarkupfalse%
\ power\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infix}\ {\isachardoublequoteopen}{\isacharcircum}{\kern0pt}{\isachardoublequoteclose}\ {\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ power{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}power\ g\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}suc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}power\ g\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ power\ g\ n\ {\isasymcdot}\ g{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}power\ g\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ power{\isadigit{0}}\ assms\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharcomma}{\kern0pt}\ auto\ simp\ add{\isacharcolon}{\kern0pt}\ assms\ power{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n\ {\isacharplus}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ assms\ power{\isadigit{0}}\ right{\isacharunderscore}{\kern0pt}unit\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n\ {\isacharplus}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}right\ assms\ associative\ \isanewline
\ \ \ \ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ power{\isacharunderscore}{\kern0pt}suc{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hind{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ local{\isachardot}{\kern0pt}inverse\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ Suc\ n\ {\isasymcdot}\ inverse\ g\ {\isacharcircum}{\kern0pt}\ Suc\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}mult\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ add{\isachardot}{\kern0pt}commute\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ \isanewline
\ \ \ \ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ left{\isacharunderscore}{\kern0pt}unit\ monoid{\isachardot}{\kern0pt}associative\ monoid{\isacharunderscore}{\kern0pt}axioms\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ power{\isacharunderscore}{\kern0pt}suc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ associative\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ assms\ hind\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ del{\isacharunderscore}{\kern0pt}insts{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ composition{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ \isanewline
\ \ \ \ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}invertible\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}inverse\ {\isacharparenleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}equality\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}powi{\isachardoublequoteclose}\ {\isadigit{8}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}power{\isacharunderscore}{\kern0pt}int\ g\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ n\ {\isasymge}\ {\isadigit{0}}\ then\ g\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}nat\ n{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ n{\isachardot}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ UNIV{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Union{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ n{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ powers\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}powers\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ n{\isachardot}{\kern0pt}\ g\ powi\ n{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ UNIV{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymsubseteq}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}nat\ n\ {\isacharequal}{\kern0pt}\ n{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UNIV{\isacharunderscore}{\kern0pt}I\ image{\isacharunderscore}{\kern0pt}iff\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hx\ power{\isadigit{0}}\ powers{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ rangeI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hpos{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ g\ powi\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ hpos\ power{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}powers\ g\ {\isacharequal}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymunion}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}powers\ g\ {\isasymsubseteq}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymunion}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}def\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymunion}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ powers\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymone}\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ rangeI\ power{\isadigit{0}}\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymsubseteq}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ assms\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}mult\ assms\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ m\ \isakeyword{where}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{and}\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n\ {\isasymge}\ m{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ k\ {\isacharplus}{\kern0pt}\ m{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ add{\isachardot}{\kern0pt}commute\ le{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}ex\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ k{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power\ assms\ associative\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ local{\isachardot}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hx\ hy\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isachardoublequoteopen}m\ {\isacharequal}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ k{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ leI\ less{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}positive{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power\ assms\ associative\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}unit\ local{\isachardot}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult\ monoid{\isachardot}{\kern0pt}invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ monoid{\isacharunderscore}{\kern0pt}axioms\ \isanewline
\ \ \ \ \ \ \ \ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hx\ hy\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}invertible\isanewline
\ \ \ \ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mult\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ sup{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ y\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ assms\ \isanewline
\ \ \ \ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mult\ inv{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}submonoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}submonoid\ {\isacharparenleft}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ M\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}locales{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ assms\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}monoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monoid\ {\isacharparenleft}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}submonoid\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ monoid{\isachardot}{\kern0pt}intro\ associative\ left{\isacharunderscore}{\kern0pt}unit\ \isanewline
\ \ \ \ \ \ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ right{\isacharunderscore}{\kern0pt}unit\ submonoid{\isachardot}{\kern0pt}sub{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}submonoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}submonoid\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ M\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}powers\ g\ {\isasymsubseteq}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ a\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ b\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ a\ {\isasymcdot}\ b\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymone}\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}monoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monoid\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ monoid{\isachardot}{\kern0pt}intro\ Un{\isacharunderscore}{\kern0pt}iff\ assms\ associative\ in{\isacharunderscore}{\kern0pt}mono\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ \isanewline
\ \ \ \ \ \ monoid{\isachardot}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ monoid{\isachardot}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}monoid\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isanewline
\ \ \ \ \ \ powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ powers{\isacharunderscore}{\kern0pt}submonoid\ submonoid{\isachardot}{\kern0pt}sub{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}closed\ submonoid{\isachardot}{\kern0pt}subset{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}u\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monoid{\isachardot}{\kern0pt}invertible\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ hu{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}u\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inverse\ u\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq\ \isanewline
\ \ \ \ \ \ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hu\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ in{\isacharunderscore}{\kern0pt}mono\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq\ \isanewline
\ \ \ \ monoid{\isachardot}{\kern0pt}invertibleI\ monoid{\isachardot}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ monoid{\isachardot}{\kern0pt}powers{\isacharunderscore}{\kern0pt}monoid\ monoid{\isacharunderscore}{\kern0pt}axioms\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}u\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monoid{\isachardot}{\kern0pt}invertible\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}aci{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ \isanewline
\ \ \ \ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}invertible\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}group{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}group\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ group{\isacharunderscore}{\kern0pt}def\ Group{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}group{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\ assms\ powers{\isacharunderscore}{\kern0pt}monoid{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}u{\isachardot}{\kern0pt}\ u\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ monoid{\isachardot}{\kern0pt}invertible\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ u{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\ \ \ \ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymnoteq}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}one\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ assms\ rangeI\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymnoteq}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}powers\ g\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ all{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}conv\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ subset{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ group\isanewline
\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}subgroup{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}subgroup\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ powers{\isacharunderscore}{\kern0pt}group\ powers{\isacharunderscore}{\kern0pt}submonoid\ subgroup{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ monoid\isanewline
\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Definition of the order of an element in a monoid%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ order\ \isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}order\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ n{\isachardot}{\kern0pt}\ n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isacharparenright}{\kern0pt}\ then\ Min\ {\isacharbraceleft}{\kern0pt}n{\isachardot}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}\ {\isasymand}\ n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharbraceright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}order\ \isakeyword{where}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}order\ {\isacharequal}{\kern0pt}\ Min\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}order\ {\isacharbackquote}{\kern0pt}\ M{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Sumset scalar multiplication cardinality lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{context}\isamarkupfalse%
\ group\isanewline
\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ A\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isasymin}\ G\ then\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ G{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}smul\ A\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ a{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ True{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ True\ card{\isacharunderscore}{\kern0pt}image{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isasymin}\ G\ then\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ G{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ True{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ True\ card{\isacharunderscore}{\kern0pt}image{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}sing{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}le{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ A\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ card{\isacharunderscore}{\kern0pt}mono\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}sing{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}le{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ card{\isacharunderscore}{\kern0pt}mono\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}a\ {\isasymin}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ \ \ B{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}B\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ B\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}B\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}inverse\ a{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ A\ B\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}clarsimp\ simp{\isacharcolon}{\kern0pt}\ smul\ image{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ Int{\isacharunderscore}{\kern0pt}iff\ invertible\ invertible{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ A\ B\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ \ finite{\isacharunderscore}{\kern0pt}smul\ surj{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isasymin}\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isasymin}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ \ \ B{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ A\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ A\ B\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}clarsimp\ simp{\isacharcolon}{\kern0pt}\ smul\ image{\isacharunderscore}{\kern0pt}iff\ associative{\isacharparenright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ Int{\isacharunderscore}{\kern0pt}iff\ invertible\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ assms{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ A\ B\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ \ finite{\isacharunderscore}{\kern0pt}smul\ surj{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ infinite{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasyminter}\ G\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}B\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ a\ \isakeyword{where}\ ha{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A\ {\isasyminter}\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Int{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}eq{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}subset\ insert{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Un\ \isanewline
\ \ \ \ mk{\isacharunderscore}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}insert\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}B\ {\isasyminter}\ G\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ inverse\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ B{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ b\ \isacommand{assume}\isamarkupfalse%
\ hb{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymin}\ B\ {\isasyminter}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ inverse\ a\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}a\ {\isasymcdot}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ associative\ ha\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ invertible{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ inverse\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ B{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ hb\ ha\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}surj\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ infinite{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}B\ {\isasyminter}\ G\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ b\ \isakeyword{where}\ hb{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymin}\ B\ {\isasyminter}\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ rev{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}subset\ smul{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isasyminter}\ G\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ inverse\ b{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ a\ \isacommand{assume}\isamarkupfalse%
\ ha{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A\ {\isasyminter}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isasymcdot}\ b{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ inverse\ b{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ associative\ hb\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ IntD{\isadigit{2}}\ invertible\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ inverse\ b{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ hb\ ha\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}surj\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Pointwise set multiplication in a group: auxiliary lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}Y\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ inverse\ {\isacharparenleft}{\kern0pt}x\ {\isasymcdot}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute\ assms\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}eqI\ in{\isacharunderscore}{\kern0pt}mono\ inverse{\isacharunderscore}{\kern0pt}equality\ invertible\ invertibleE\ smul{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ inverse\ y\ {\isasymcdot}\ inverse\ x{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}cases\ image{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute\ assms\ smul{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ in{\isacharunderscore}{\kern0pt}mono\ invertible{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hXn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ associative\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}mono\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ assms\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ associative\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ assms\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ y\ x\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ y\ {\isasymcdot}\ inverse\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ smul{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ empty{\isacharunderscore}{\kern0pt}iff\ insert{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ associative\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ g\ {\isasymcdot}\ inverse\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ associative\ subset{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ smul{\isachardot}{\kern0pt}simps\ hx\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Union{\isadigit{2}}\ \isanewline
\ \ \ \ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Union\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isanewline
\ \ \ \ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ assms\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/IsabelleProjects/Generalized_Cauchy_Davenport/Generalized_Cauchy_Davenport_preliminaries.thy%:%
%:%11=1%:%
%:%27=14%:%
%:%28=14%:%
%:%29=15%:%
%:%30=16%:%
%:%31=17%:%
%:%32=18%:%
%:%33=19%:%
%:%47=21%:%
%:%57=23%:%
%:%58=23%:%
%:%59=24%:%
%:%60=25%:%
%:%61=26%:%
%:%62=27%:%
%:%63=28%:%
%:%64=29%:%
%:%71=30%:%
%:%72=30%:%
%:%73=31%:%
%:%74=31%:%
%:%75=32%:%
%:%76=32%:%
%:%77=33%:%
%:%78=33%:%
%:%79=34%:%
%:%80=35%:%
%:%81=35%:%
%:%82=36%:%
%:%83=36%:%
%:%84=37%:%
%:%85=38%:%
%:%86=38%:%
%:%87=39%:%
%:%88=39%:%
%:%89=39%:%
%:%90=40%:%
%:%91=40%:%
%:%92=40%:%
%:%93=41%:%
%:%94=41%:%
%:%95=41%:%
%:%96=42%:%
%:%97=42%:%
%:%98=42%:%
%:%99=43%:%
%:%100=43%:%
%:%101=43%:%
%:%102=44%:%
%:%103=44%:%
%:%104=45%:%
%:%105=45%:%
%:%106=46%:%
%:%107=46%:%
%:%108=47%:%
%:%109=47%:%
%:%110=48%:%
%:%111=48%:%
%:%112=49%:%
%:%113=49%:%
%:%114=49%:%
%:%115=50%:%
%:%116=51%:%
%:%117=51%:%
%:%118=51%:%
%:%119=52%:%
%:%120=52%:%
%:%121=52%:%
%:%122=53%:%
%:%123=53%:%
%:%124=54%:%
%:%125=54%:%
%:%126=55%:%
%:%127=55%:%
%:%128=55%:%
%:%129=56%:%
%:%130=56%:%
%:%131=56%:%
%:%132=57%:%
%:%138=57%:%
%:%141=58%:%
%:%142=59%:%
%:%143=59%:%
%:%144=60%:%
%:%145=61%:%
%:%146=62%:%
%:%147=63%:%
%:%150=64%:%
%:%154=64%:%
%:%155=64%:%
%:%156=65%:%
%:%157=65%:%
%:%162=65%:%
%:%165=66%:%
%:%166=67%:%
%:%167=67%:%
%:%168=68%:%
%:%169=69%:%
%:%176=71%:%
%:%186=73%:%
%:%187=73%:%
%:%188=74%:%
%:%189=75%:%
%:%190=76%:%
%:%191=77%:%
%:%192=77%:%
%:%193=78%:%
%:%194=79%:%
%:%195=79%:%
%:%198=80%:%
%:%202=80%:%
%:%203=80%:%
%:%208=80%:%
%:%211=81%:%
%:%212=82%:%
%:%213=82%:%
%:%216=83%:%
%:%220=83%:%
%:%221=83%:%
%:%226=83%:%
%:%229=84%:%
%:%230=85%:%
%:%231=85%:%
%:%234=86%:%
%:%238=86%:%
%:%239=86%:%
%:%244=86%:%
%:%247=87%:%
%:%248=88%:%
%:%249=88%:%
%:%252=89%:%
%:%256=89%:%
%:%257=89%:%
%:%262=89%:%
%:%265=90%:%
%:%266=91%:%
%:%267=91%:%
%:%270=92%:%
%:%274=92%:%
%:%275=92%:%
%:%280=92%:%
%:%283=93%:%
%:%284=94%:%
%:%285=94%:%
%:%288=95%:%
%:%292=95%:%
%:%293=95%:%
%:%298=95%:%
%:%301=96%:%
%:%302=97%:%
%:%303=97%:%
%:%306=98%:%
%:%310=98%:%
%:%311=98%:%
%:%316=98%:%
%:%319=99%:%
%:%320=100%:%
%:%321=100%:%
%:%324=101%:%
%:%328=101%:%
%:%329=101%:%
%:%334=101%:%
%:%337=102%:%
%:%338=103%:%
%:%339=103%:%
%:%342=104%:%
%:%346=104%:%
%:%347=104%:%
%:%352=104%:%
%:%355=105%:%
%:%356=106%:%
%:%357=106%:%
%:%360=107%:%
%:%364=107%:%
%:%365=107%:%
%:%370=107%:%
%:%373=108%:%
%:%374=109%:%
%:%375=109%:%
%:%378=110%:%
%:%382=110%:%
%:%383=110%:%
%:%388=110%:%
%:%391=111%:%
%:%392=112%:%
%:%393=112%:%
%:%396=113%:%
%:%400=113%:%
%:%401=113%:%
%:%406=113%:%
%:%409=114%:%
%:%410=115%:%
%:%411=115%:%
%:%414=116%:%
%:%418=116%:%
%:%419=116%:%
%:%424=116%:%
%:%427=117%:%
%:%428=118%:%
%:%429=118%:%
%:%432=119%:%
%:%436=119%:%
%:%437=119%:%
%:%442=119%:%
%:%445=120%:%
%:%446=121%:%
%:%447=121%:%
%:%448=122%:%
%:%449=123%:%
%:%452=124%:%
%:%456=124%:%
%:%457=124%:%
%:%458=124%:%
%:%463=124%:%
%:%466=125%:%
%:%467=126%:%
%:%468=126%:%
%:%471=127%:%
%:%475=127%:%
%:%476=127%:%
%:%481=127%:%
%:%484=128%:%
%:%485=129%:%
%:%486=129%:%
%:%489=130%:%
%:%493=130%:%
%:%494=130%:%
%:%499=130%:%
%:%502=131%:%
%:%503=132%:%
%:%504=132%:%
%:%507=133%:%
%:%511=133%:%
%:%512=133%:%
%:%517=133%:%
%:%520=134%:%
%:%521=135%:%
%:%522=135%:%
%:%523=136%:%
%:%526=137%:%
%:%530=137%:%
%:%531=137%:%
%:%536=137%:%
%:%539=138%:%
%:%540=139%:%
%:%541=139%:%
%:%542=140%:%
%:%545=141%:%
%:%549=141%:%
%:%550=141%:%
%:%551=141%:%
%:%556=141%:%
%:%559=142%:%
%:%560=143%:%
%:%561=143%:%
%:%562=144%:%
%:%563=145%:%
%:%566=146%:%
%:%570=146%:%
%:%571=146%:%
%:%572=146%:%
%:%586=148%:%
%:%596=149%:%
%:%597=149%:%
%:%598=150%:%
%:%599=151%:%
%:%600=152%:%
%:%601=153%:%
%:%602=154%:%
%:%603=154%:%
%:%604=155%:%
%:%605=156%:%
%:%607=156%:%
%:%611=156%:%
%:%612=156%:%
%:%613=156%:%
%:%620=156%:%
%:%621=157%:%
%:%622=158%:%
%:%623=158%:%
%:%624=159%:%
%:%625=160%:%
%:%626=161%:%
%:%629=162%:%
%:%633=162%:%
%:%634=162%:%
%:%635=163%:%
%:%641=163%:%
%:%644=164%:%
%:%645=165%:%
%:%646=165%:%
%:%647=166%:%
%:%648=167%:%
%:%655=168%:%
%:%656=168%:%
%:%657=169%:%
%:%658=169%:%
%:%659=170%:%
%:%660=170%:%
%:%661=170%:%
%:%662=170%:%
%:%663=170%:%
%:%664=171%:%
%:%665=171%:%
%:%666=172%:%
%:%667=172%:%
%:%668=173%:%
%:%669=173%:%
%:%670=174%:%
%:%671=174%:%
%:%672=174%:%
%:%673=174%:%
%:%674=174%:%
%:%675=175%:%
%:%676=176%:%
%:%682=176%:%
%:%685=177%:%
%:%686=178%:%
%:%687=178%:%
%:%688=179%:%
%:%689=180%:%
%:%696=181%:%
%:%697=181%:%
%:%698=182%:%
%:%699=182%:%
%:%700=183%:%
%:%701=183%:%
%:%702=183%:%
%:%703=183%:%
%:%704=183%:%
%:%705=184%:%
%:%706=184%:%
%:%707=185%:%
%:%708=185%:%
%:%709=186%:%
%:%710=186%:%
%:%711=187%:%
%:%712=187%:%
%:%713=187%:%
%:%714=188%:%
%:%715=188%:%
%:%716=188%:%
%:%717=189%:%
%:%718=190%:%
%:%719=190%:%
%:%720=190%:%
%:%721=190%:%
%:%722=190%:%
%:%723=191%:%
%:%724=192%:%
%:%730=192%:%
%:%733=193%:%
%:%734=194%:%
%:%735=194%:%
%:%736=195%:%
%:%737=196%:%
%:%739=196%:%
%:%743=196%:%
%:%744=196%:%
%:%745=196%:%
%:%746=197%:%
%:%753=197%:%
%:%754=198%:%
%:%755=199%:%
%:%756=199%:%
%:%757=200%:%
%:%758=201%:%
%:%761=202%:%
%:%765=202%:%
%:%766=202%:%
%:%767=202%:%
%:%772=202%:%
%:%775=203%:%
%:%776=204%:%
%:%777=204%:%
%:%778=205%:%
%:%779=206%:%
%:%780=207%:%
%:%781=207%:%
%:%782=208%:%
%:%783=209%:%
%:%784=209%:%
%:%786=209%:%
%:%790=209%:%
%:%791=209%:%
%:%792=209%:%
%:%799=209%:%
%:%800=210%:%
%:%801=211%:%
%:%802=211%:%
%:%803=212%:%
%:%804=213%:%
%:%805=213%:%
%:%806=214%:%
%:%813=215%:%
%:%814=215%:%
%:%815=216%:%
%:%816=216%:%
%:%817=216%:%
%:%818=217%:%
%:%819=217%:%
%:%820=217%:%
%:%821=217%:%
%:%822=217%:%
%:%823=218%:%
%:%824=218%:%
%:%825=218%:%
%:%826=218%:%
%:%827=219%:%
%:%828=219%:%
%:%829=220%:%
%:%835=220%:%
%:%838=221%:%
%:%839=222%:%
%:%840=222%:%
%:%841=223%:%
%:%848=224%:%
%:%849=224%:%
%:%850=225%:%
%:%851=225%:%
%:%852=225%:%
%:%853=226%:%
%:%854=226%:%
%:%855=226%:%
%:%856=226%:%
%:%857=226%:%
%:%858=227%:%
%:%859=227%:%
%:%860=227%:%
%:%861=228%:%
%:%862=228%:%
%:%863=229%:%
%:%864=229%:%
%:%865=230%:%
%:%866=230%:%
%:%867=230%:%
%:%868=230%:%
%:%869=231%:%
%:%870=231%:%
%:%871=232%:%
%:%872=232%:%
%:%873=233%:%
%:%874=233%:%
%:%875=234%:%
%:%876=234%:%
%:%877=234%:%
%:%878=234%:%
%:%879=235%:%
%:%880=235%:%
%:%881=235%:%
%:%882=235%:%
%:%883=235%:%
%:%884=236%:%
%:%885=236%:%
%:%886=236%:%
%:%887=236%:%
%:%888=236%:%
%:%889=237%:%
%:%890=237%:%
%:%891=238%:%
%:%897=238%:%
%:%900=239%:%
%:%901=240%:%
%:%902=240%:%
%:%903=241%:%
%:%910=242%:%
%:%911=242%:%
%:%912=243%:%
%:%913=243%:%
%:%914=244%:%
%:%915=244%:%
%:%916=244%:%
%:%917=245%:%
%:%918=245%:%
%:%919=246%:%
%:%920=246%:%
%:%921=247%:%
%:%922=247%:%
%:%923=248%:%
%:%929=248%:%
%:%932=249%:%
%:%933=250%:%
%:%934=250%:%
%:%937=251%:%
%:%941=251%:%
%:%942=251%:%
%:%943=251%:%
%:%948=251%:%
%:%951=252%:%
%:%952=253%:%
%:%953=253%:%
%:%954=254%:%
%:%955=255%:%
%:%958=256%:%
%:%962=256%:%
%:%963=256%:%
%:%964=256%:%
%:%969=256%:%
%:%972=257%:%
%:%973=258%:%
%:%974=258%:%
%:%975=259%:%
%:%976=260%:%
%:%979=261%:%
%:%983=261%:%
%:%984=261%:%
%:%985=261%:%
%:%990=261%:%
%:%993=262%:%
%:%994=263%:%
%:%995=263%:%
%:%996=264%:%
%:%997=265%:%
%:%1004=266%:%
%:%1005=266%:%
%:%1006=267%:%
%:%1007=267%:%
%:%1008=267%:%
%:%1009=268%:%
%:%1010=268%:%
%:%1011=268%:%
%:%1012=268%:%
%:%1013=268%:%
%:%1014=269%:%
%:%1015=269%:%
%:%1016=270%:%
%:%1017=270%:%
%:%1018=271%:%
%:%1019=271%:%
%:%1020=272%:%
%:%1021=272%:%
%:%1022=272%:%
%:%1023=272%:%
%:%1024=272%:%
%:%1025=273%:%
%:%1026=273%:%
%:%1027=273%:%
%:%1028=273%:%
%:%1029=274%:%
%:%1030=274%:%
%:%1031=275%:%
%:%1032=275%:%
%:%1033=275%:%
%:%1034=275%:%
%:%1035=275%:%
%:%1036=276%:%
%:%1037=276%:%
%:%1038=277%:%
%:%1039=277%:%
%:%1040=278%:%
%:%1041=278%:%
%:%1042=278%:%
%:%1043=278%:%
%:%1044=279%:%
%:%1045=279%:%
%:%1046=279%:%
%:%1047=279%:%
%:%1048=280%:%
%:%1049=280%:%
%:%1050=281%:%
%:%1051=282%:%
%:%1052=282%:%
%:%1053=282%:%
%:%1054=282%:%
%:%1055=282%:%
%:%1056=283%:%
%:%1057=283%:%
%:%1058=284%:%
%:%1064=284%:%
%:%1067=285%:%
%:%1068=286%:%
%:%1069=286%:%
%:%1070=287%:%
%:%1071=288%:%
%:%1074=289%:%
%:%1078=289%:%
%:%1079=289%:%
%:%1080=290%:%
%:%1085=290%:%
%:%1088=291%:%
%:%1089=292%:%
%:%1090=292%:%
%:%1091=293%:%
%:%1092=294%:%
%:%1095=295%:%
%:%1099=295%:%
%:%1100=295%:%
%:%1101=296%:%
%:%1102=296%:%
%:%1107=296%:%
%:%1110=297%:%
%:%1111=298%:%
%:%1112=298%:%
%:%1113=299%:%
%:%1114=300%:%
%:%1117=301%:%
%:%1121=301%:%
%:%1122=301%:%
%:%1123=302%:%
%:%1124=302%:%
%:%1125=303%:%
%:%1131=303%:%
%:%1134=304%:%
%:%1135=305%:%
%:%1136=305%:%
%:%1137=306%:%
%:%1138=307%:%
%:%1141=308%:%
%:%1145=308%:%
%:%1146=308%:%
%:%1147=308%:%
%:%1148=309%:%
%:%1153=309%:%
%:%1156=310%:%
%:%1157=311%:%
%:%1158=311%:%
%:%1159=312%:%
%:%1160=313%:%
%:%1167=314%:%
%:%1168=314%:%
%:%1169=315%:%
%:%1170=315%:%
%:%1171=315%:%
%:%1172=315%:%
%:%1173=316%:%
%:%1174=316%:%
%:%1175=317%:%
%:%1176=317%:%
%:%1177=318%:%
%:%1178=318%:%
%:%1179=318%:%
%:%1180=319%:%
%:%1181=319%:%
%:%1182=320%:%
%:%1183=320%:%
%:%1184=320%:%
%:%1185=320%:%
%:%1186=321%:%
%:%1192=321%:%
%:%1195=322%:%
%:%1196=323%:%
%:%1197=323%:%
%:%1198=324%:%
%:%1199=325%:%
%:%1202=326%:%
%:%1206=326%:%
%:%1207=326%:%
%:%1208=327%:%
%:%1209=328%:%
%:%1214=328%:%
%:%1217=329%:%
%:%1218=330%:%
%:%1219=330%:%
%:%1220=331%:%
%:%1221=332%:%
%:%1228=333%:%
%:%1229=333%:%
%:%1230=334%:%
%:%1231=334%:%
%:%1232=334%:%
%:%1233=334%:%
%:%1234=335%:%
%:%1235=335%:%
%:%1236=335%:%
%:%1237=335%:%
%:%1238=336%:%
%:%1239=336%:%
%:%1240=337%:%
%:%1241=337%:%
%:%1242=337%:%
%:%1243=337%:%
%:%1244=337%:%
%:%1245=338%:%
%:%1246=339%:%
%:%1252=339%:%
%:%1255=340%:%
%:%1256=341%:%
%:%1257=341%:%
%:%1258=342%:%
%:%1259=343%:%
%:%1262=344%:%
%:%1266=344%:%
%:%1267=344%:%
%:%1268=344%:%
%:%1269=345%:%
%:%1274=345%:%
%:%1277=346%:%
%:%1278=347%:%
%:%1279=347%:%
%:%1280=348%:%
%:%1281=349%:%
%:%1288=350%:%
%:%1289=350%:%
%:%1290=351%:%
%:%1291=351%:%
%:%1292=351%:%
%:%1293=352%:%
%:%1294=352%:%
%:%1295=353%:%
%:%1301=353%:%
%:%1304=354%:%
%:%1305=355%:%
%:%1306=355%:%
%:%1307=356%:%
%:%1308=357%:%
%:%1315=358%:%
%:%1316=358%:%
%:%1317=359%:%
%:%1318=359%:%
%:%1319=359%:%
%:%1320=359%:%
%:%1321=360%:%
%:%1322=360%:%
%:%1323=360%:%
%:%1324=360%:%
%:%1325=360%:%
%:%1326=361%:%
%:%1332=361%:%
%:%1335=362%:%
%:%1336=363%:%
%:%1337=363%:%
%:%1338=364%:%
%:%1339=365%:%
%:%1341=365%:%
%:%1345=365%:%
%:%1346=365%:%
%:%1347=366%:%
%:%1348=366%:%
%:%1355=366%:%
%:%1356=367%:%
%:%1357=368%:%
%:%1358=368%:%
%:%1359=369%:%
%:%1360=370%:%
%:%1361=370%:%
%:%1362=371%:%
%:%1363=372%:%
%:%1364=373%:%
%:%1365=374%:%
%:%1366=374%:%
%:%1367=375%:%
%:%1368=376%:%
%:%1371=377%:%
%:%1375=377%:%
%:%1376=377%:%
%:%1381=377%:%
%:%1384=378%:%
%:%1385=379%:%
%:%1386=379%:%
%:%1387=380%:%
%:%1388=381%:%
%:%1389=381%:%
%:%1390=382%:%
%:%1391=383%:%
%:%1398=385%:%
%:%1408=386%:%
%:%1409=386%:%
%:%1410=387%:%
%:%1411=388%:%
%:%1412=389%:%
%:%1413=389%:%
%:%1414=390%:%
%:%1415=391%:%
%:%1423=393%:%
%:%1433=394%:%
%:%1434=394%:%
%:%1435=395%:%
%:%1436=396%:%
%:%1437=397%:%
%:%1438=398%:%
%:%1439=398%:%
%:%1440=399%:%
%:%1447=400%:%
%:%1448=400%:%
%:%1449=401%:%
%:%1450=401%:%
%:%1451=402%:%
%:%1452=402%:%
%:%1453=402%:%
%:%1454=403%:%
%:%1455=403%:%
%:%1456=404%:%
%:%1457=404%:%
%:%1458=404%:%
%:%1459=405%:%
%:%1460=405%:%
%:%1461=406%:%
%:%1462=406%:%
%:%1463=406%:%
%:%1464=407%:%
%:%1465=407%:%
%:%1466=408%:%
%:%1467=408%:%
%:%1472=408%:%
%:%1475=409%:%
%:%1476=410%:%
%:%1477=410%:%
%:%1478=411%:%
%:%1485=412%:%
%:%1486=412%:%
%:%1487=413%:%
%:%1488=413%:%
%:%1489=414%:%
%:%1490=414%:%
%:%1491=414%:%
%:%1492=415%:%
%:%1493=415%:%
%:%1494=416%:%
%:%1495=416%:%
%:%1496=416%:%
%:%1497=417%:%
%:%1498=417%:%
%:%1499=418%:%
%:%1500=418%:%
%:%1501=418%:%
%:%1502=419%:%
%:%1503=419%:%
%:%1504=420%:%
%:%1505=420%:%
%:%1510=420%:%
%:%1513=421%:%
%:%1514=422%:%
%:%1515=422%:%
%:%1516=423%:%
%:%1519=424%:%
%:%1523=424%:%
%:%1524=424%:%
%:%1529=424%:%
%:%1532=425%:%
%:%1533=426%:%
%:%1534=426%:%
%:%1535=427%:%
%:%1538=428%:%
%:%1542=428%:%
%:%1543=428%:%
%:%1548=428%:%
%:%1551=429%:%
%:%1552=430%:%
%:%1553=430%:%
%:%1554=431%:%
%:%1555=432%:%
%:%1556=433%:%
%:%1563=434%:%
%:%1564=434%:%
%:%1565=435%:%
%:%1566=435%:%
%:%1567=436%:%
%:%1568=436%:%
%:%1569=437%:%
%:%1570=437%:%
%:%1571=438%:%
%:%1572=438%:%
%:%1573=438%:%
%:%1574=439%:%
%:%1575=439%:%
%:%1576=439%:%
%:%1577=440%:%
%:%1578=440%:%
%:%1579=441%:%
%:%1585=441%:%
%:%1588=442%:%
%:%1589=443%:%
%:%1590=443%:%
%:%1591=444%:%
%:%1592=445%:%
%:%1593=446%:%
%:%1600=447%:%
%:%1601=447%:%
%:%1602=448%:%
%:%1603=448%:%
%:%1604=449%:%
%:%1605=449%:%
%:%1606=450%:%
%:%1607=450%:%
%:%1608=451%:%
%:%1609=451%:%
%:%1610=451%:%
%:%1611=452%:%
%:%1612=452%:%
%:%1613=452%:%
%:%1614=453%:%
%:%1615=453%:%
%:%1616=454%:%
%:%1622=454%:%
%:%1625=455%:%
%:%1626=456%:%
%:%1627=457%:%
%:%1628=457%:%
%:%1629=458%:%
%:%1630=459%:%
%:%1637=460%:%
%:%1638=460%:%
%:%1639=461%:%
%:%1640=461%:%
%:%1641=462%:%
%:%1642=462%:%
%:%1643=462%:%
%:%1644=462%:%
%:%1645=463%:%
%:%1646=463%:%
%:%1647=463%:%
%:%1648=463%:%
%:%1649=463%:%
%:%1650=464%:%
%:%1651=465%:%
%:%1652=465%:%
%:%1653=465%:%
%:%1654=466%:%
%:%1655=466%:%
%:%1656=467%:%
%:%1657=467%:%
%:%1658=467%:%
%:%1659=468%:%
%:%1660=468%:%
%:%1661=468%:%
%:%1662=468%:%
%:%1663=468%:%
%:%1664=469%:%
%:%1665=469%:%
%:%1666=469%:%
%:%1667=469%:%
%:%1668=469%:%
%:%1669=470%:%
%:%1670=470%:%
%:%1671=471%:%
%:%1672=471%:%
%:%1673=471%:%
%:%1674=471%:%
%:%1675=471%:%
%:%1676=471%:%
%:%1677=472%:%
%:%1683=472%:%
%:%1686=473%:%
%:%1687=474%:%
%:%1688=474%:%
%:%1689=475%:%
%:%1690=476%:%
%:%1697=477%:%
%:%1698=477%:%
%:%1699=478%:%
%:%1700=478%:%
%:%1701=479%:%
%:%1702=479%:%
%:%1703=479%:%
%:%1704=479%:%
%:%1705=480%:%
%:%1706=480%:%
%:%1707=480%:%
%:%1708=480%:%
%:%1709=480%:%
%:%1710=481%:%
%:%1711=481%:%
%:%1712=481%:%
%:%1713=482%:%
%:%1714=482%:%
%:%1715=483%:%
%:%1716=483%:%
%:%1717=483%:%
%:%1718=484%:%
%:%1719=484%:%
%:%1720=484%:%
%:%1721=484%:%
%:%1722=485%:%
%:%1723=485%:%
%:%1724=486%:%
%:%1725=486%:%
%:%1726=486%:%
%:%1727=486%:%
%:%1728=486%:%
%:%1729=487%:%
%:%1730=487%:%
%:%1731=488%:%
%:%1732=488%:%
%:%1733=488%:%
%:%1734=488%:%
%:%1735=488%:%
%:%1736=488%:%
%:%1737=489%:%
%:%1752=491%:%
%:%1762=492%:%
%:%1763=492%:%
%:%1764=493%:%
%:%1765=494%:%
%:%1772=495%:%
%:%1773=495%:%
%:%1774=496%:%
%:%1775=496%:%
%:%1776=497%:%
%:%1777=497%:%
%:%1778=498%:%
%:%1779=498%:%
%:%1780=498%:%
%:%1781=499%:%
%:%1782=499%:%
%:%1783=499%:%
%:%1784=500%:%
%:%1785=500%:%
%:%1786=501%:%
%:%1787=501%:%
%:%1788=501%:%
%:%1789=502%:%
%:%1790=502%:%
%:%1791=503%:%
%:%1792=503%:%
%:%1793=504%:%
%:%1794=504%:%
%:%1795=505%:%
%:%1796=505%:%
%:%1797=506%:%
%:%1798=506%:%
%:%1799=507%:%
%:%1800=507%:%
%:%1801=507%:%
%:%1802=508%:%
%:%1803=508%:%
%:%1804=508%:%
%:%1805=509%:%
%:%1806=509%:%
%:%1807=509%:%
%:%1808=510%:%
%:%1809=510%:%
%:%1810=510%:%
%:%1811=510%:%
%:%1812=511%:%
%:%1813=511%:%
%:%1814=512%:%
%:%1815=512%:%
%:%1816=513%:%
%:%1822=513%:%
%:%1825=514%:%
%:%1826=515%:%
%:%1827=515%:%
%:%1828=516%:%
%:%1829=517%:%
%:%1830=518%:%
%:%1837=519%:%
%:%1838=519%:%
%:%1839=520%:%
%:%1840=520%:%
%:%1841=521%:%
%:%1842=521%:%
%:%1843=521%:%
%:%1844=521%:%
%:%1845=521%:%
%:%1846=522%:%
%:%1847=522%:%
%:%1848=523%:%
%:%1849=523%:%
%:%1850=524%:%
%:%1851=524%:%
%:%1852=525%:%
%:%1853=525%:%
%:%1854=525%:%
%:%1855=526%:%
%:%1856=526%:%
%:%1857=527%:%
%:%1858=527%:%
%:%1859=528%:%
%:%1860=528%:%
%:%1861=529%:%
%:%1862=529%:%
%:%1863=529%:%
%:%1864=530%:%
%:%1865=530%:%
%:%1866=530%:%
%:%1867=530%:%
%:%1868=530%:%
%:%1869=531%:%
%:%1870=531%:%
%:%1871=531%:%
%:%1872=531%:%
%:%1873=531%:%
%:%1874=532%:%
%:%1875=532%:%
%:%1876=532%:%
%:%1877=532%:%
%:%1878=533%:%
%:%1879=533%:%
%:%1880=534%:%
%:%1881=534%:%
%:%1882=535%:%
%:%1883=535%:%
%:%1884=536%:%
%:%1885=536%:%
%:%1886=537%:%
%:%1887=537%:%
%:%1888=538%:%
%:%1889=538%:%
%:%1890=538%:%
%:%1891=539%:%
%:%1892=539%:%
%:%1893=539%:%
%:%1894=539%:%
%:%1895=539%:%
%:%1896=540%:%
%:%1897=540%:%
%:%1898=540%:%
%:%1899=541%:%
%:%1900=541%:%
%:%1901=541%:%
%:%1902=542%:%
%:%1903=542%:%
%:%1904=542%:%
%:%1905=542%:%
%:%1906=543%:%
%:%1907=543%:%
%:%1908=544%:%
%:%1909=544%:%
%:%1910=545%:%
%:%1911=545%:%
%:%1912=546%:%
%:%1913=546%:%
%:%1914=546%:%
%:%1915=546%:%
%:%1916=546%:%
%:%1917=547%:%
%:%1923=547%:%
%:%1926=548%:%
%:%1927=549%:%
%:%1928=549%:%
%:%1929=550%:%
%:%1930=551%:%
%:%1931=552%:%
%:%1938=553%:%
%:%1939=553%:%
%:%1940=554%:%
%:%1941=554%:%
%:%1942=555%:%
%:%1943=555%:%
%:%1944=556%:%
%:%1945=556%:%
%:%1946=557%:%
%:%1947=557%:%
%:%1948=558%:%
%:%1949=558%:%
%:%1950=558%:%
%:%1951=559%:%
%:%1952=559%:%
%:%1953=559%:%
%:%1954=560%:%
%:%1955=560%:%
%:%1956=560%:%
%:%1957=561%:%
%:%1958=561%:%
%:%1959=561%:%
%:%1960=561%:%
%:%1961=561%:%
%:%1962=562%:%
%:%1963=562%:%
%:%1964=563%:%
%:%1965=563%:%
%:%1966=564%:%
%:%1967=564%:%
%:%1968=565%:%
%:%1969=565%:%
%:%1970=566%:%
%:%1971=566%:%
%:%1972=566%:%
%:%1973=567%:%
%:%1974=567%:%
%:%1975=567%:%
%:%1976=567%:%
%:%1977=567%:%
%:%1978=568%:%
%:%1979=568%:%
%:%1980=568%:%
%:%1981=568%:%
%:%1982=568%:%
%:%1983=569%:%
%:%1984=569%:%
%:%1985=570%:%
%:%1986=570%:%
%:%1987=571%:%
%:%1988=571%:%
%:%1989=571%:%
%:%1990=571%:%
%:%1991=571%:%
%:%1992=572%:%
%:%1993=572%:%
%:%1994=572%:%
%:%1995=572%:%
%:%1996=572%:%
%:%1997=573%:%
%:%2003=573%:%
%:%2006=574%:%
%:%2007=575%:%
%:%2008=575%:%
%:%2009=576%:%
%:%2010=577%:%
%:%2011=578%:%
%:%2013=578%:%
%:%2017=578%:%
%:%2018=578%:%
%:%2019=579%:%
%:%2020=580%:%
%:%2021=580%:%
%:%2028=580%:%
%:%2029=581%:%
%:%2030=582%:%
%:%2031=582%:%
%:%2034=583%:%
%:%2039=584%:%
